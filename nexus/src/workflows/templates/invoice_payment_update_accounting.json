{
  "id": "invoice_payment_update_accounting",
  "name": "Invoice Payment to Accounting Update",
  "name_ar": "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¯ÙØ¹Ø§Øª",
  "description": "When a Stripe payment is received, update Google Sheets accounting ledger, send notifications, and optionally process KNET payments for Kuwait customers. Perfect for SMEs tracking revenue.",
  "description_ar": "Ø¹Ù†Ø¯ Ø§Ø³ØªÙ„Ø§Ù… Ø¯ÙØ¹Ø© StripeØŒ ØªØ­Ø¯ÙŠØ« Ø¯ÙØªØ± Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© ÙÙŠ Google SheetsØŒ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§ØªØŒ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø¯ÙØ¹Ø§Øª KNET Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„ÙƒÙˆÙŠØªÙŠÙŠÙ†. Ù…Ø«Ø§Ù„ÙŠ Ù„Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ØµØºÙŠØ±Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª.",
  "domain": "sme",
  "roiTier": 1,
  "annualValue": "$19,968/year",
  "requiredIntegrations": ["stripe", "googlesheets", "slack"],
  "optionalIntegrations": ["gmail", "whatsapp", "knet"],
  "exampleUserInput": "When I receive a payment on Stripe, update my accounting spreadsheet and notify me on Slack",
  "exampleUserInput_ar": "Ø¹Ù†Ø¯Ù…Ø§ Ø£Ø³ØªÙ„Ù… Ø¯ÙØ¹Ø© Ø¹Ù„Ù‰ StripeØŒ Ø­Ø¯Ø« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© ÙˆØ£Ø´Ø¹Ø±Ù†ÙŠ Ø¹Ù„Ù‰ Slack",
  "keywords": ["invoice", "payment", "stripe", "accounting", "spreadsheet", "sheets", "ledger", "notify", "revenue", "knet", "ÙØ§ØªÙˆØ±Ø©", "Ø¯ÙØ¹Ø©", "Ù…Ø­Ø§Ø³Ø¨Ø©", "Ø¥ÙŠØ±Ø§Ø¯Ø§Øª", "ÙƒÙŠ Ù†Øª"],
  "dynamicParameters": {
    "payment_notification_channel": {
      "type": "string",
      "default": "#payments",
      "label": "Slack channel for notifications",
      "label_ar": "Ù‚Ù†Ø§Ø© Slack Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª",
      "required": true
    },
    "spreadsheet_name": {
      "type": "string",
      "default": "Revenue Tracker 2026",
      "label": "Google Sheets name",
      "label_ar": "Ø§Ø³Ù… Ø¬Ø¯ÙˆÙ„ Google Sheets",
      "required": true
    },
    "currency": {
      "type": "select",
      "options": ["KWD", "SAR", "AED", "USD", "EUR"],
      "default": "KWD",
      "label": "Primary Currency",
      "label_ar": "Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"
    },
    "language": {
      "type": "select",
      "options": ["english", "arabic", "bilingual"],
      "default": "bilingual",
      "label": "Notification Language",
      "label_ar": "Ù„ØºØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª"
    },
    "send_receipt_whatsapp": {
      "type": "boolean",
      "default": true,
      "label": "Send receipt via WhatsApp",
      "label_ar": "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨"
    },
    "knet_enabled": {
      "type": "boolean",
      "default": false,
      "label": "Enable KNET payment processing (Kuwait)",
      "label_ar": "ØªÙØ¹ÙŠÙ„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¯ÙØ¹Ø§Øª KNET (Ø§Ù„ÙƒÙˆÙŠØª)",
      "description": "Placeholder for KNET integration - requires custom setup"
    },
    "vat_rate": {
      "type": "number",
      "default": 5,
      "label": "VAT Rate (%)",
      "label_ar": "Ù†Ø³Ø¨Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (%)"
    }
  },
  "messages": {
    "payment_received_en": "ğŸ’° *Payment Received!*\n\nAmount: {{currency}} {{amount}}\nCustomer: {{customer_name}}\nInvoice: {{invoice_id}}\nDate: {{payment_date}}\nMethod: {{payment_method}}\n\nâœ… Recorded in accounting sheet.",
    "payment_received_ar": "ğŸ’° *ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¯ÙØ¹Ø©!*\n\nØ§Ù„Ù…Ø¨Ù„Øº: {{currency}} {{amount}}\nØ§Ù„Ø¹Ù…ÙŠÙ„: {{customer_name}}\nØ§Ù„ÙØ§ØªÙˆØ±Ø©: {{invoice_id}}\nØ§Ù„ØªØ§Ø±ÙŠØ®: {{payment_date}}\nØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: {{payment_method}}\n\nâœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡Ø§ ÙÙŠ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©.",
    "payment_received_bilingual": "ğŸ’° *Payment Received! / ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¯ÙØ¹Ø©!*\n\nAmount / Ø§Ù„Ù…Ø¨Ù„Øº: {{currency}} {{amount}}\nCustomer / Ø§Ù„Ø¹Ù…ÙŠÙ„: {{customer_name}}\nInvoice / Ø§Ù„ÙØ§ØªÙˆØ±Ø©: {{invoice_id}}\nDate / Ø§Ù„ØªØ§Ø±ÙŠØ®: {{payment_date}}\n\nâœ… Recorded / ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "receipt_whatsapp_en": "ğŸ§¾ *Payment Receipt*\n\nThank you for your payment, {{customer_name}}!\n\nAmount: {{currency}} {{amount}}\nInvoice: #{{invoice_id}}\nDate: {{payment_date}}\n\nThis serves as your official receipt.\n\nQuestions? Reply to this message.\n\nThank you for your business!\n{{company_name}}",
    "receipt_whatsapp_ar": "ğŸ§¾ *Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯ÙØ¹*\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ø¯ÙØ¹ØªÙƒØŒ {{customer_name}}!\n\nØ§Ù„Ù…Ø¨Ù„Øº: {{currency}} {{amount}}\nØ§Ù„ÙØ§ØªÙˆØ±Ø©: #{{invoice_id}}\nØ§Ù„ØªØ§Ø±ÙŠØ®: {{payment_date}}\n\nÙ‡Ø°Ø§ Ø¨Ù…Ø«Ø§Ø¨Ø© Ø¥ÙŠØµØ§Ù„Ùƒ Ø§Ù„Ø±Ø³Ù…ÙŠ.\n\nØ£Ø³Ø¦Ù„Ø©ØŸ Ø±Ø¯ Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„Ùƒ Ù…Ø¹Ù†Ø§!\n{{company_name}}",
    "daily_summary_en": "ğŸ“Š *Daily Revenue Summary*\n\nDate: {{date}}\n\nTotal Payments: {{payment_count}}\nTotal Revenue: {{currency}} {{total_revenue}}\nVAT Collected: {{currency}} {{vat_amount}}\n\nTop Customers:\n{{#each top_customers}}\nâ€¢ {{name}}: {{currency}} {{amount}}\n{{/each}}\n\nView full report: {{sheet_link}}",
    "knet_placeholder_en": "âš ï¸ *KNET Integration Required*\n\nTo process KNET payments, please contact support@nexus.app to set up your KNET merchant account integration.\n\nKNET is Kuwait's primary payment gateway and requires:\n- Merchant ID\n- Terminal ID\n- API credentials",
    "knet_placeholder_ar": "âš ï¸ *Ù…Ø·Ù„ÙˆØ¨ ØªÙƒØ§Ù…Ù„ KNET*\n\nÙ„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¯ÙØ¹Ø§Øª KNETØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ support@nexus.app Ù„Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙƒØ§Ù…Ù„ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ§Ø¬Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.\n\nKNET Ù‡ÙŠ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ø§Ù„ÙƒÙˆÙŠØª ÙˆØªØªØ·Ù„Ø¨:\n- Ù…Ø¹Ø±Ù Ø§Ù„ØªØ§Ø¬Ø±\n- Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø­Ø·Ø©\n- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ API"
  },
  "executionPlan": {
    "tasks": [
      {
        "id": "task_1",
        "name": "Receive Stripe Payment",
        "name_ar": "Ø§Ø³ØªÙ„Ø§Ù… Ø¯ÙØ¹Ø© Stripe",
        "type": "trigger",
        "integrationId": "stripe",
        "dependencies": [],
        "config": {
          "toolSlug": "STRIPE_PAYMENT_INTENT_SUCCEEDED",
          "action": "webhook",
          "params": {
            "eventType": "payment_intent.succeeded"
          }
        }
      },
      {
        "id": "task_2",
        "name": "Extract Payment Details",
        "name_ar": "Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙØ¹Ø©",
        "type": "action",
        "integrationId": "system",
        "dependencies": ["task_1"],
        "config": {
          "toolSlug": "SYSTEM_PROCESS",
          "action": "transform",
          "params": {
            "input": "{{task_1.data}}",
            "mapping": {
              "amount": "{{task_1.amount / 100}}",
              "currency": "{{task_1.currency.toUpperCase()}}",
              "customer_id": "{{task_1.customer}}",
              "invoice_id": "{{task_1.invoice}}",
              "payment_date": "{{task_1.created | date}}",
              "payment_method": "{{task_1.payment_method_types[0]}}"
            }
          }
        }
      },
      {
        "id": "task_3",
        "name": "Get Customer Details from Stripe",
        "name_ar": "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† Stripe",
        "type": "action",
        "integrationId": "stripe",
        "dependencies": ["task_2"],
        "config": {
          "toolSlug": "STRIPE_GET_CUSTOMER",
          "action": "get",
          "params": {
            "customerId": "{{task_2.customer_id}}"
          }
        }
      },
      {
        "id": "task_4",
        "name": "Update Accounting Sheet",
        "name_ar": "ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©",
        "type": "action",
        "integrationId": "googlesheets",
        "dependencies": ["task_3"],
        "config": {
          "toolSlug": "GOOGLESHEETS_BATCH_UPDATE",
          "action": "append",
          "params": {
            "spreadsheetId": "{{spreadsheet_id}}",
            "sheetName": "Payments",
            "values": [
              "{{task_2.payment_date}}",
              "{{task_3.name}}",
              "{{task_3.email}}",
              "{{task_2.invoice_id}}",
              "{{task_2.amount}}",
              "{{task_2.currency}}",
              "{{task_2.amount * (vat_rate / 100)}}",
              "{{task_2.payment_method}}",
              "Stripe"
            ]
          }
        }
      },
      {
        "id": "task_5",
        "name": "Send Slack Notification",
        "name_ar": "Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Slack",
        "type": "action",
        "integrationId": "slack",
        "dependencies": ["task_4"],
        "config": {
          "toolSlug": "SLACK_SEND_MESSAGE",
          "action": "send",
          "params": {
            "channel": "{{payment_notification_channel}}",
            "message": "{{messages.payment_received_{{language}}}}"
          }
        }
      },
      {
        "id": "task_6",
        "name": "Send Receipt via WhatsApp",
        "name_ar": "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨",
        "type": "action",
        "integrationId": "whatsapp",
        "dependencies": ["task_4"],
        "config": {
          "toolSlug": "WHATSAPP_SEND_MESSAGE",
          "action": "send",
          "params": {
            "to": "{{task_3.phone}}",
            "message": "{{messages.receipt_whatsapp_{{language}}}}",
            "condition": "send_receipt_whatsapp === true && task_3.phone"
          }
        }
      },
      {
        "id": "task_7",
        "name": "Send Email Receipt",
        "name_ar": "Ø¥Ø±Ø³Ø§Ù„ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
        "type": "action",
        "integrationId": "gmail",
        "dependencies": ["task_4"],
        "config": {
          "toolSlug": "GMAIL_SEND_EMAIL",
          "action": "send",
          "params": {
            "to": "{{task_3.email}}",
            "subject": "Payment Receipt #{{task_2.invoice_id}} / Ø¥ÙŠØµØ§Ù„ Ø¯ÙØ¹",
            "body": "{{messages.receipt_whatsapp_{{language}}}}"
          }
        }
      },
      {
        "id": "task_8",
        "name": "Daily Revenue Summary",
        "name_ar": "Ù…Ù„Ø®Øµ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠ",
        "type": "trigger",
        "integrationId": "system",
        "dependencies": [],
        "config": {
          "toolSlug": "SYSTEM_SCHEDULE",
          "action": "cron",
          "params": {
            "schedule": "0 18 * * 0-4",
            "description": "Daily summary at 6 PM (Sunday-Thursday)",
            "timezone": "{{timezone}}"
          }
        }
      },
      {
        "id": "task_9",
        "name": "Generate Daily Summary",
        "name_ar": "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…ÙŠ",
        "type": "action",
        "integrationId": "googlesheets",
        "dependencies": ["task_8"],
        "config": {
          "toolSlug": "GOOGLESHEETS_GET_VALUES",
          "action": "query",
          "params": {
            "spreadsheetId": "{{spreadsheet_id}}",
            "range": "Payments!A:I",
            "filter": "date = today()"
          }
        }
      },
      {
        "id": "task_10",
        "name": "Send Daily Summary to Slack",
        "name_ar": "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø¥Ù„Ù‰ Slack",
        "type": "action",
        "integrationId": "slack",
        "dependencies": ["task_9"],
        "config": {
          "toolSlug": "SLACK_SEND_MESSAGE",
          "action": "send",
          "params": {
            "channel": "{{payment_notification_channel}}",
            "message": "{{messages.daily_summary_en}}"
          }
        }
      }
    ],
    "requiredIntegrations": ["stripe", "googlesheets", "slack"]
  },
  "preFlightQuestions": [
    {
      "id": "spreadsheet_name",
      "question": "What's the name of your accounting spreadsheet?",
      "question_ar": "Ù…Ø§ Ø§Ø³Ù… Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒØŸ",
      "type": "text",
      "default": "Revenue Tracker 2026"
    },
    {
      "id": "currency",
      "question": "What's your primary currency?",
      "question_ar": "Ù…Ø§ Ù‡ÙŠ Ø¹Ù…Ù„ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŸ",
      "type": "select",
      "options": [
        {"value": "KWD", "label": "Kuwaiti Dinar (KWD)"},
        {"value": "SAR", "label": "Saudi Riyal (SAR)"},
        {"value": "AED", "label": "UAE Dirham (AED)"},
        {"value": "USD", "label": "US Dollar (USD)"}
      ],
      "default": "KWD"
    },
    {
      "id": "vat_rate",
      "question": "What's your VAT rate?",
      "question_ar": "Ù…Ø§ Ù†Ø³Ø¨Ø© Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©ØŸ",
      "type": "number",
      "default": 5
    },
    {
      "id": "send_receipt_whatsapp",
      "question": "Send receipts via WhatsApp?",
      "question_ar": "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ØŸ",
      "type": "boolean",
      "default": true
    },
    {
      "id": "language",
      "question": "What language should notifications be in?",
      "question_ar": "Ø¨Ø£ÙŠ Ù„ØºØ© ÙŠØ¬Ø¨ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§ØªØŸ",
      "type": "select",
      "options": [
        {"value": "english", "label": "English"},
        {"value": "arabic", "label": "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"},
        {"value": "bilingual", "label": "Both / ÙƒÙ„Ø§Ù‡Ù…Ø§"}
      ],
      "default": "bilingual"
    }
  ],
  "regionalConfig": {
    "kuwait": {
      "timezone": "Asia/Kuwait",
      "workDays": [0, 1, 2, 3, 4],
      "businessHours": {"start": "09:00", "end": "17:00"},
      "defaultLanguage": "bilingual",
      "currency": "KWD",
      "vat_rate": 0,
      "paymentMethods": ["stripe", "knet"],
      "knetNote": "KNET is the primary payment gateway in Kuwait. Contact support for integration."
    },
    "saudi": {
      "timezone": "Asia/Riyadh",
      "workDays": [0, 1, 2, 3, 4],
      "businessHours": {"start": "09:00", "end": "17:00"},
      "defaultLanguage": "arabic",
      "currency": "SAR",
      "vat_rate": 15,
      "paymentMethods": ["stripe", "mada"]
    },
    "uae": {
      "timezone": "Asia/Dubai",
      "workDays": [1, 2, 3, 4, 5],
      "businessHours": {"start": "09:00", "end": "18:00"},
      "defaultLanguage": "english",
      "currency": "AED",
      "vat_rate": 5,
      "paymentMethods": ["stripe", "card"]
    }
  }
}
